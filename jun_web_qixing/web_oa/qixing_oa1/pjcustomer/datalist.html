<!DOCTYPE html>
<html lang="zh">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="renderer" content="webkit" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="mobile-prefetch" href="" />
	<title>勾股OA</title>
	<link rel="stylesheet" href="/static/assets/gougu/css/gougu.css?v=5.7.5" media="all">


	<script>
		const login_admin = 2;
	</script>

</head>

<body class="main-body">
	<!-- 主体 -->

	<div class="p-page">
		<div class="gg-form-bar border-t border-x">
			<form class="layui-form" lay-filter="barsearchform">
				<div class="layui-input-inline" style="width:240px;">
					<input type="text" name="customerName" placeholder="客户名称" class="layui-input" autocomplete="off" />
				</div>
				<div class="layui-input-inline" style="width:240px;">
					<input type="text" name="customerCode" placeholder="客户编码" class="layui-input" autocomplete="off" />
				</div>
				<div class="layui-input-inline" style="width:240px;">
					<input type="text" name="dictCustomerType" placeholder="客户类型" class="layui-input"
						autocomplete="off" />
				</div>
				<div class="layui-input-inline" style="width:150px;">
					<button class="layui-btn layui-btn-normal" lay-submit="" lay-filter="table-search"><i
							class="layui-icon layui-icon-search mr-1"></i>搜索</button>
					<button type="reset" class="layui-btn layui-btn-reset" lay-filter="table-reset">清空</button>
				</div>
			</form>
		</div>
		<table class="layui-hide" id="document" lay-filter="document"></table>
	</div>
	<script type="text/html" id="toolbarDemo">
  <div class="layui-btn-container">
  	<button class="layui-btn layui-btn-sm" lay-event="add">+ 新增客户</button>
    <button class="layui-btn layui-btn-sm layui-btn-danger" lay-event="batchDeleted">删除</button>
	<button class="layui-btn layui-btn-sm" lay-event="submit">提交审批</button>
	<button class="layui-btn layui-btn-sm layui-btn-primary" lay-event="export">导出</button>
  </div>
</script>

	<!-- /主体 -->

	<!-- 底部 -->

	<!-- /底部 -->

	<!-- 脚本 -->

	<script>
		const moduleInit = ['tool','xnUtil', 'tablePlus', 'oaPicker'];
		function gouguInit() {
			var table = layui.tablePlus, form = layui.form, tool = layui.tool;

			layui.documentTable = table.render({
				elem: '#document',
				title: '客户列表',
				toolbar: '#toolbarDemo',
				headers: { "Authorization": localStorage.getItem("Authorization") },
				contentType: 'application/json',
				is_excel: true,
				cellMinWidth: 80,
				height: 'full-114',
				url: "/dev-api/pjCustomer/listByPage",
				method: 'POST',
				parseData: function (res) {
					return {
						"code": res.code,
						"msg": res.msg,
						"count": res.data ? res.data.total : 0,
						"data": res.data ? res.data.records : []
					}
				},
				cols: [[
					{ type: 'checkbox', fixed: 'left' },
					{ field: 'id', title: '客户ID', sort: true, hide: true },
					{ field: 'customerName', title: '客户名称', width: 140, sort: true },
					{ field: 'customerCode', title: '客户编码', sort: true, hide: true },
					{
						field: 'dictCustomerType', title: '客户类型', sort: true, templet: function (item) { 	            //获取类型对应的字典label
							var datas = xnUtil.getDictDataByDictTypeCode('dict_customer_type', null);
							if (item.dictCustomerType % 2 == 0) {
								return '<span class="layui-btn layui-btn-normal layui-btn-xs">' + CoreUtil.selectDictLabel(datas, item.dictCustomerType) + '</span>';
							} else {
								return '<span class="layui-btn layui-btn-warm layui-btn-xs">' + CoreUtil.selectDictLabel(datas, item.dictCustomerType) + '</span>';
							}
							// return CoreUtil.selectDictLabel(datas, item.dictCustomerType);
						}
					},
					{ field: 'phone', title: '公司电话', sort: true },
					{ field: 'financialManager', title: '联系人1', sort: true, hide: false },
					{ field: 'fmPhone', title: '联系人电话1', sort: true, hide: true },
					{ field: 'financialManager1', title: '联系人2', sort: true, hide: true },
					{ field: 'fmPhone1', title: '联系人电话2', sort: true, hide: true },
					{ field: 'financialManager2', title: '联系人3', sort: true, hide: true },
					{ field: 'fmPhone2', title: '联系电话3', sort: true, hide: true },
					{ field: 'customerLinks', title: '客户联系信息', sort: true, hide: true },
					{ field: 'customerBusiness', title: '客户营业信息', sort: true, hide: true },
					{ field: 'businessLicense', title: '营业执照', sort: true, hide: true },
					{ field: 'conpanyName', title: '公司全称', sort: true, hide: true },
					{ field: 'businessLicenseNo', title: '营业执照编码', sort: true, hide: true },
					{ field: 'legalRepresentative', title: '法定代表人', sort: true, hide: true },
					{ field: 'registeredCapital', title: '注册资本', sort: true, hide: false },
					{ field: 'customerAddress', title: '客户地址', sort: true, hide: true },
					{
						field: 'dictCompanyType', title: '公司类型', sort: true, hide: false, templet: function (item) { 	            //获取类型对应的字典label
							var datas = xnUtil.getDictDataByDictTypeCode('dict_company_type', null);
							if (item.dictCustomerType % 2 == 0) {
								return '<span class="layui-btn layui-btn-normal layui-btn-xs">' + CoreUtil.selectDictLabel(datas, item.dictCustomerType) + '</span>';
							} else {
								return '<span class="layui-btn layui-btn-warm layui-btn-xs">' + CoreUtil.selectDictLabel(datas, item.dictCustomerType) + '</span>';
							}
						}
					},
					{ field: 'companyBegin', title: '公司始建于', sort: true, hide: true },
					{ field: 'paiclupCapital', title: '实收资本', sort: true, hide: true },
					{ field: 'businessScope', title: '经营范围', sort: true, hide: true },
					{ field: 'businessTermStart', title: '营业期限开始', sort: true, hide: true },
					{ field: 'businessTermEnd', title: '营业期限结束', sort: true, hide: true },
					{ field: 'registrationAuthority', title: '登记机关', sort: true, hide: true },
					{ field: 'licensingDay', title: '执照发放日', sort: true, hide: true },
					{ field: 'customerBillingInformation', title: '客户开票信息', sort: true, hide: true },
					{ field: 'taxRegNumber', title: '纳税人识别号', sort: true, hide: true },
					{ field: 'dutyParagraph', title: '税号', sort: true, hide: true },
					{ field: 'openingBank', title: '开户行', sort: true, hide: true },
					{ field: 'accountNumber', title: '账号', sort: true, hide: true },
					{ field: 'telephone', title: '电话', sort: true, hide: true },
					{ field: 'companyAddress', title: '公司地址', sort: true, hide: true },
					{
						field: 'dictIsOldCustomer', title: '是否老客户', sort: true, hide: false, templet: function (item) { 	            //获取类型对应的字典label
							var datas = xnUtil.getDictDataByDictTypeCode('dict_is_old_customer', null);
							if (item.dictIsOldCustomer % 2 == 0) {
								return '<span class="layui-btn layui-btn-normal layui-btn-xs">' + CoreUtil.selectDictLabel(datas, item.dictIsOldCustomer) + '</span>';
							} else {
								return '<span class="layui-btn layui-btn-warm layui-btn-xs">' + CoreUtil.selectDictLabel(datas, item.dictIsOldCustomer) + '</span>';
							}
							// return CoreUtil.selectDictLabel(datas, item.dictIsOldCustomer);
						}
					},
					{ field: 'customerRespPerson', title: '客户对接责任人', sort: true, hide: false },
					{ field: 'customerRelationPerson', title: '客户关系维护责任人', sort: true, hide: true },
					{ field: 'creator', title: '创建人', sort: true, hide: false },
					//   流程新增字段   beggin    flow_test1  <!-- 流程flow-mark001,新增流程列表字段，查询流程状态及处理人信息 -->
					{
						title: '流程状态', field: 'orderState', align: 'center', width: 90, templet: function (d) {
							if (d.orderState == 0) {
								return '<span style="color: #eb7350;">审批完成</span>'
							} else if (d.orderState == 1) {
								return '<span style="color: #00b487;">审批中</span>'
							} else {
								return '<span style="color: blue;">未审批</span>'
							}
						}
					},
					{ title: '当前节点', field: 'taskName', align: 'center', width: 105, hide: false },
					{ title: '当前处理人', field: 'taskOperatorName', align: 'center', width: 90, hide: false },
					{ field: 'isOwner', title: 'isOwner', hide: true },
					//   流程新增字段   end  <!-- 流程flow-mark001,新增流程列表字段，查询流程状态及处理人信息 -->
					{ field: 'remark', title: '备注信息', sort: true, hide: true },
					{ field: 'editor', title: '编辑权限', sort: true, hide: true },
					{ field: 'isOwner', hide: true }
					, {
						field: 'right',
						fixed: 'right',
						title: '操作',
						width: 200,
						align: 'center',
						templet: function (d) {
							var html = '<div class="layui-btn-group">';
							var btn1 = '<span class="layui-btn layui-btn-normal layui-btn-xs" lay-event="view">查看</span>';
							var btn2 = '<span class="layui-btn layui-btn-xs" lay-event="edit">编辑</span>';
							var btn3 = '<span class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</span>';
							var btn4 = '<span class="layui-btn layui-btn-warm layui-btn-xs" lay-event="attachment">附件上传</span>';
							var btn5 = '<span class="layui-btn layui-btn-primary layui-btn-xs" lay-event="auth">编辑权限</span>';

							return html + btn1 + btn2 + btn3 + btn4 + btn5 + '</div>';
						}
					}
				]]
			});


			//触发事件
			table.on('toolbar(document)', function (obj) {
				var checkStatus = table.checkStatus(obj.config.id);
				var data = checkStatus.data;

				switch (obj.event) {
					case 'add':
						tool.side("/qixing_oa1/pjcustomer/add.html");
						return;
					case 'batchDeleted':
						if (data.length == 0) {
							layer.msg("请选择要删除的记录");
							return;
						}
						var ids = [];
						$(data).each(function (index, item) {
							ids.push(item.id);
						});
						tipDialog(ids);
						break;
					case 'submit':
						if (data.length == 0) {
							layer.msg("请选择要提交的记录");
							return;
						} else if (data.length > 1) {
							layer.msg("请选择一条记录进行提交");
							return;
						}
						tool.side('/table/doSubmit.html');
						break;
					case 'export':
						exportData();
						break;
				}
			});

			//监听行工具事件
			table.on('tool(document)', function (obj) {
				var data = obj.data;
				switch (obj.event) {
					case 'view':
						tool.side("/qixing_oa1/pjcustomer/view.html?id=" + data.id);
						return;
					case 'edit':
						tool.side('/qixing_oa1/pjcustomer/edit.html?id=' + data.id);
						return;
					case 'del':
						var ids = [];
						ids.push(data.id);
						tipDialog(ids);
						break;
					case 'attachment':
						// 附件上传功能
						alert('附件上传功能');
						break;
					case 'auth':
						// 编辑权限功能
						alert('编辑权限功能');
						break;
				}
			});

			//删除确认
			function tipDialog(ids) {
				layer.confirm('确定要删除么?', {
					title: '提示'
				}, function (index) {
					layer.close(index);
					tool.delete("/dev-api/pjCustomer/delete", { ids: ids }, function (res) {
						layer.msg(res.msg);
						if (res.code == 0) {
							layui.documentTable.reload();
						}
					});
				});
			}

			// 导出数据
			function exportData() {
				// 导出功能实现
				alert('导出数据功能');
			}

			//搜索事件
			form.on('submit(table-search)', function (data) {
				layui.documentTable.reload({
					where: data.field,
					page: { curr: 1 }
				});
				return false;
			});
		}		
	</script>

	<!-- /脚本 -->
	<script src="/static/assets/layui/layui.js"></script>
	<script src="/static/assets/gougu/gouguInit.js?v=5.7.5"></script>


	<div class="copyright">Copyright © 2022-2025 勾股OA - 5.7.5 ，Powered by GouguOPEN<a href="https://www.gougucms.com"
			target="_blank">官网</a><a href="https://blog.gougucms.com" target="_blank">社区</a><a
			href="https://blog.gougucms.com/home/book/detail/bid/3/id/7.html" target="_blank">文档</a></div>
	</div>

	<!-- /版权标识 -->
</body>

</html>